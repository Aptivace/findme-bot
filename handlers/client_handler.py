from aiogram import Router, Bot
from aiogram.types import Message, CallbackQuery
from aiogram.filters import Command
from aiogram.fsm.context import FSMContext

from utils import states, database
from config import developers, TOKEN, channel
from keyboards import client_kb

formClient = states.Client

base = database.DataBase()

client = Bot(TOKEN, parse_mode='HTML') 

chat_members = ['LEFT', 'KICKED', 'RESTRICTED'] # –º–∞—Å—Å–∏–≤ —Å—Ç–∞—Ç—É—Å–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

router = Router()

@router.message(Command('start'))
async def start(message: Message, state: FSMContext):
    check_member = await client.get_chat_member(chat_id=channel, user_id=message.from_user.id) # –ø–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∫–∞–Ω–∞–ª–µ

    if str(check_member.status).split('.')[-1] in chat_members: # –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 
        return await message.answer('–í—ã –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –∫–∞–Ω–∞–ª‚ùó\n\n–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±—ã—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–º –Ω–∞ <a href="https://t.me/NaidiMeniaMckKtits">–∫–∞–Ω–∞–ª</a>.')
    
    await state.set_state(formClient.ptype) # —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∞—à–∏–Ω—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π
    await message.answer('<b>üëã –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!</b>\n\n<b>–í –¥–∞–Ω–Ω–æ–º –±–æ—Ç–µ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å <i>—Å–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</i>, –Ω–æ –æ–Ω–æ –±—É–¥–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–±–ª—é–¥–µ–Ω–∏–∏ <u>—Ä—è–¥–∞ –ø—Ä–∞–≤–∏–ª</u>:</b>\n\n1Ô∏è‚É£ <b> –ü–æ—Å—Ç –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ <u>–û–î–ù–£</u> —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –∏–ª–∏ –≤–∏–¥–µ–æ <u>–ù–ï –ë–û–õ–¨–®–ï 20 –°–ï–ö–£–ù–î</u></b>\n(–Ω–µ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –±–æ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ —Ñ–æ—Ç–æ –∏–ª–∏ –≤–∏–¥–µ–æ)\n\n<b>‚úÖ –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –æ–±—ä—è–≤–ª–µ–Ω–∏—è</b>', reply_markup=client_kb.choose_type())


@router.callback_query(client_kb.Postination.filter()) # –ª—é—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–ª–±—ç–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
async def choose_post(query: CallbackQuery, callback_data: client_kb.Postination, state: FSMContext):
    if callback_data.action == 'naydi': # –Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ "–ù–∞–π–¥–∏ –º–µ–Ω—è"
        await state.update_data(post_type = '–Ω–∞–π–¥–∏_–º–µ–Ω—è') # –∑–∞–ø–∏—Å—å —Ç–∏–ø–∞ –ø–æ—Å—Ç–∞ –≤ –º–∞—à–∏–Ω—É —Å–æ—Å—Ç–æ—è–Ω–∏–π
        await query.message.delete_reply_markup() # —É–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –≤ —Ü–µ–ª—è—Ö –∑–∞—â–∏—Ç—ã –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è 
        await query.message.edit_text('<b>üìé –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Ñ–æ—Ç–æ –∏–ª–∏ –≤–∏–¥–µ–æ –∏ —Ç–µ–∫—Å—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è\n( –æ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–∏–¥–µ–æ <i>–ù–ï –ë–û–õ–¨–®–ï</i> 20 —Å–µ–∫—É–Ω–¥ )\n\n‚ö†Ô∏è –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥—É—é –æ–ø—Ü–∏—é –æ—Ç–ø—Ä–∞–≤–∫–∏,\n–Ω–∞–ø–∏—à–∏—Ç–µ /start –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞</b>') # —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞, —á—Ç–æ–±—ã –Ω–µ –∑–∞—Å–æ—Ä—è—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∫—É
        await query.answer() # –∑–∞–≤–µ—Ä—à–∞–µ–º –∫–æ–ª–±—ç–∫ –ø—É—Å—Ç—ã–º –æ—Ç–≤–µ—Ç–æ–º
        return await state.set_state(formClient.array) # –º–µ–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–µ 
    
    if callback_data.action == 'poteryashka': # –Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ "–ü–æ—Ç–µ—Ä—è—à–∫–∏"
        await state.update_data(post_type = '–ø–æ—Ç–µ—Ä—è—à–∫–∞')
        await query.message.delete_reply_markup()
        await query.message.edit_text('<b>üìé –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Ñ–æ—Ç–æ –∏–ª–∏ –≤–∏–¥–µ–æ –∏ —Ç–µ–∫—Å—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è\n( –æ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–∏–¥–µ–æ <i>–ù–ï –ë–û–õ–¨–®–ï</i> 20 —Å–µ–∫—É–Ω–¥ )\n\n‚ö†Ô∏è –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥—É—é –æ–ø—Ü–∏—é –æ—Ç–ø—Ä–∞–≤–∫–∏,\n–Ω–∞–ø–∏—à–∏—Ç–µ /start –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞</b>')
        await query.answer()
        return await state.set_state(formClient.array)

        
@router.message(formClient.array) # —Ñ—É–Ω–∫—Ü–∏—è –º–∞—à–∏–Ω—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π
async def form_name(message: Message, state: FSMContext):
    if message.photo: # –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ñ–æ—Ç–æ
        if message.caption == None: # –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ç–µ–∫—Å—Ç–∞ (–æ–ø–∏—Å–∞–Ω–∏—è –ø–æ—Å—Ç–∞)
            await message.answer('<b>–û–±—ä—è–≤–ª–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ‚ùó</b>\n\n‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ /start —á—Ç–æ–±—ã –≤—ã–ª–æ–∂–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ <i>–∑–∞–Ω–æ–≤–æ</i>.')
            return await state.clear()
        
        await state.update_data(
            userid = message.from_user.id, # –ø–æ–ª—É—á–µ–Ω–∏–µ user_id
            media = message.photo[-1].file_id, # –ø–æ–ª—É—á–µ–Ω–∏–µ file_id –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ñ–æ—Ç–æ –≤ —Å–ø–∏—Å–∫–µ (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã—Å—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞)
            description = message.caption, # –ø–æ–ª—É—á–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Å—Ç–∞
            video = False # –¥–∞–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
        )

        await message.answer('–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é –æ—Ç–ø—Ä–∞–≤–∫–∏:', reply_markup=client_kb.anonim()) # –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
        return await state.set_state(formClient.anon) # –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–µ
    
    if message.video: # –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≤–∏–¥–µ–æ
        if message.caption == None:
            await message.answer('<b>–û–±—ä—è–≤–ª–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ‚ùó</b>\n\n‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ /start —á—Ç–æ–±—ã –≤—ã–ª–æ–∂–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ <i>–∑–∞–Ω–æ–≤–æ</i>.')
            return await state.clear()
        
        if message.video.duration > 21: # –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–∏–¥–µ–æ
            return await message.answer('<b>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–∏–¥–µ–æ –ø—Ä–µ–≤—ã—à–∞–µ—Ç <i>20</i> —Å–µ–∫—É–Ω–¥</b>‚ùó\n\n<b>–û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤–∏–¥–µ–æ <i>–∫–æ—Ä–æ—á–µ</i> –∏ <u>–ü–û–í–¢–û–†–ù–û</u> <i>—É–∫–∞–∂–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ</i>.</b>')
        
        await state.update_data(
            userid = message.from_user.id,
            media = message.video.file_id,
            description = message.caption,
            video = True
        )
    
        await message.answer('–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é –æ—Ç–ø—Ä–∞–≤–∫–∏:', reply_markup=client_kb.anonim())
        return await state.set_state(formClient.anon)

    await state.update_data(
        userid = message.from_user.id,
        media = None,
        description = message.text,
    ) # —ç—Ç–∞ –∑–∞–ø–∏—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø—Ä–∏–∫—Ä–µ–ø–∏–ª –º–µ–¥–∏–∞-—Ñ–∞–π–ª—ã

    await message.answer('–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é –æ—Ç–ø—Ä–∞–≤–∫–∏:', reply_markup=client_kb.anonim())
    await state.set_state(formClient.anon)


@router.callback_query(client_kb.Anonimation.filter())
async def choose_anon(query: CallbackQuery, callback_data: client_kb.Anonimation, state: FSMContext):
    data = await state.get_data() # –ø–æ–ª—É—á–∞–µ–º —Å–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –º–∞—à–∏–Ω—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π
    current_state = await state.get_state() # –ø–æ–ª—É—á–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–∞—à–∏–Ω—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π (—Ç–∞–≤—Ç–æ–ª–æ–≥–∏—è –Ω–∞—à–µ –≤—Å—ë)
    if callback_data.action == 'otkat': # –Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã
        if current_state: # –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            await state.clear() # –æ—á–∏—Å—Ç–∫–∞ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –º–∞—à–∏–Ω—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π
            await query.message.delete_reply_markup()
            return await query.message.answer('‚ö†Ô∏è –û—Ç–ø—Ä–∞–≤–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞')
        return

    if callback_data.action == 'anon': # –Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ –∞–Ω–æ–Ω–∏–º–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
        if data['media'] == None: # –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–µ–¥–∏–∞-—Ñ–∞–π–ª
            await base.create_anon(data=data) # –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –ø–æ—Å—Ç –≤ –ë–î
            await query.message.delete_reply_markup()
            await query.message.edit_text('<b>‚úÖ –°–ø–∞—Å–∏–±–æ!</b>\n\n–ï—Å–ª–∏ –≤—ã <b><u>–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</u></b> –ø—Ä–µ–¥–ª–æ–∂–∏–ª–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ, —Ç–æ, –ø–æ—Å–ª–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –≤–∞—à–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ.\n–ú–æ–¥–µ—Ä–∞—Ü–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç –¥–æ <b><i>12 —á–∞—Å–æ–≤</i></b>.\n\n<b>–°–ø–∏—Å–æ–∫ —Å–∞–º—ã—Ö —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫:</b>\n\n1Ô∏è‚É£ –í—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç–µ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –ø–æ—Å—Ç\n2Ô∏è‚É£ –í–∞—à –ø–æ—Å—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–º–∞—Ç–∏–∫–µ –∫–∞–Ω–∞–ª–∞\n3Ô∏è‚É£ –í–∞—à –ø–æ—Å—Ç –Ω–µ–∞–¥–µ–∫–≤–∞—Ç–Ω—ã–π –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ç–µ–∫—Å—Ç\n\n–¢–µ–ø–µ—Ä—å –≤—ã –∑–Ω–∞–µ—Ç–µ –æ –≤—Å–µ–≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö. –ò—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç–µ –ø–æ—Å—Ç –µ—â–µ —Ä–∞–∑üëç\n\n<b>–ß—Ç–æ–±—ã –≤—ã–ª–æ–∂–∏—Ç—å –µ—â–µ –æ–¥–Ω–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è, –Ω–∞–∂–º–∏—Ç–µ /start</b>')
            await query.answer()
            for developer in developers: # –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º
                await client.send_message(chat_id=developer, text='<b>üõéÔ∏è –ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ!</b>\n\n<b>–í–≤–µ–¥–∏—Ç–µ <i>/pending</i> —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–µ—Å—å —Å–ø–∏—Å–æ–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏—Ö—Å—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π.</b>')
            return await state.clear()
        
        await base.create_anon_media(data=data)
        await query.message.delete_reply_markup()
        await query.message.edit_text('<b>‚úÖ –°–ø–∞—Å–∏–±–æ!</b>\n\n–ï—Å–ª–∏ –≤—ã <b><u>–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</u></b> –ø—Ä–µ–¥–ª–æ–∂–∏–ª–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ, —Ç–æ, –ø–æ—Å–ª–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –≤–∞—à–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ.\n–ú–æ–¥–µ—Ä–∞—Ü–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç –¥–æ <b><i>12 —á–∞—Å–æ–≤</i></b>.\n\n<b>–°–ø–∏—Å–æ–∫ —Å–∞–º—ã—Ö —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫:</b>\n\n1Ô∏è‚É£ –í—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç–µ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –ø–æ—Å—Ç\n2Ô∏è‚É£ –í–∞—à –ø–æ—Å—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–º–∞—Ç–∏–∫–µ –∫–∞–Ω–∞–ª–∞\n3Ô∏è‚É£ –í–∞—à –ø–æ—Å—Ç –Ω–µ–∞–¥–µ–∫–≤–∞—Ç–Ω—ã–π –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ç–µ–∫—Å—Ç\n\n–¢–µ–ø–µ—Ä—å –≤—ã –∑–Ω–∞–µ—Ç–µ –æ –≤—Å–µ–≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö. –ò—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç–µ –ø–æ—Å—Ç –µ—â–µ —Ä–∞–∑üëç\n\n<b>–ß—Ç–æ–±—ã –≤—ã–ª–æ–∂–∏—Ç—å –µ—â–µ –æ–¥–Ω–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è, –Ω–∞–∂–º–∏—Ç–µ /start</b>')
        await query.answer()
        for developer in developers:
            await client.send_message(chat_id=developer, text='<b>üõéÔ∏è –ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ!</b>\n\n<b>–í–≤–µ–¥–∏—Ç–µ <i>/pending</i> —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–µ—Å—å —Å–ø–∏—Å–æ–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏—Ö—Å—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π.</b>')
        return await state.clear()
    
    if not query.from_user.username:
        await query.message.delete_reply_markup()
        await query.message.edit_text('<b>‚õî –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞!</b>\n\n–ù–µ–ª—å–∑—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ <b><u>–ø—É–±–ª–∏—á–Ω–æ</u></b> –±–µ–∑ —é–∑–µ—Ä–Ω–µ–π–º–∞!\n–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–≥–æ –º–æ–∂–Ω–æ <b><i>–Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ—Ñ–∏–ª—è</i></b>')
        await query.answer()
        return await state.clear()

    if data['media'] == None:
        await base.create_ticket(data=data, query=query)
        await query.message.delete_reply_markup()
        await query.message.edit_text('<b>‚úÖ –°–ø–∞—Å–∏–±–æ!</b>\n\n–ï—Å–ª–∏ –≤—ã <b><u>–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</u></b> –ø—Ä–µ–¥–ª–æ–∂–∏–ª–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ, —Ç–æ, –ø–æ—Å–ª–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –≤–∞—à–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ.\n–ú–æ–¥–µ—Ä–∞—Ü–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç –¥–æ <b><i>12 —á–∞—Å–æ–≤</i></b>.\n\n<b>–°–ø–∏—Å–æ–∫ —Å–∞–º—ã—Ö —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫:</b>\n\n1Ô∏è‚É£ –í—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç–µ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –ø–æ—Å—Ç\n2Ô∏è‚É£ –í–∞—à –ø–æ—Å—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–º–∞—Ç–∏–∫–µ –∫–∞–Ω–∞–ª–∞\n3Ô∏è‚É£ –í–∞—à –ø–æ—Å—Ç –Ω–µ –∞–¥–µ–∫–≤–∞—Ç–Ω—ã–π\n\n–¢–µ–ø–µ—Ä—å –≤—ã –∑–Ω–∞–µ—Ç–µ –æ –≤—Å–µ–≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö. –ò—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç–µ –ø–æ—Å—Ç –µ—â–µ —Ä–∞–∑üëç\n\n<b>–ß—Ç–æ–±—ã –≤—ã–ª–æ–∂–∏—Ç—å –µ—â–µ –æ–¥–Ω–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è, –Ω–∞–∂–º–∏—Ç–µ /start</b>')
        await query.answer()
        for developer in developers:
            await client.send_message(chat_id=developer, text='<b>üõéÔ∏è –ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ!</b>\n\n<b>–í–≤–µ–¥–∏—Ç–µ <i>/pending</i> —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–µ—Å—å —Å–ø–∏—Å–æ–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏—Ö—Å—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π.</b>')
        return await state.clear()
    
    await base.create_ticket_media(data=data, query=query)
    await query.message.delete_reply_markup()
    await query.message.edit_text('<b>‚úÖ –°–ø–∞—Å–∏–±–æ!</b>\n\n–ï—Å–ª–∏ –≤—ã <b><u>–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</u></b> –ø—Ä–µ–¥–ª–æ–∂–∏–ª–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ, —Ç–æ, –ø–æ—Å–ª–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –≤–∞—à–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ.\n–ú–æ–¥–µ—Ä–∞—Ü–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç –¥–æ <b><i>12 —á–∞—Å–æ–≤</i></b>.\n\n<b>–°–ø–∏—Å–æ–∫ —Å–∞–º—ã—Ö —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫:</b>\n\n1Ô∏è‚É£ –í—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç–µ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –ø–æ—Å—Ç\n2Ô∏è‚É£ –í–∞—à –ø–æ—Å—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–º–∞—Ç–∏–∫–µ –∫–∞–Ω–∞–ª–∞\n3Ô∏è‚É£ –í–∞—à –ø–æ—Å—Ç –Ω–µ –∞–¥–µ–∫–≤–∞—Ç–Ω—ã–π\n\n–¢–µ–ø–µ—Ä—å –≤—ã –∑–Ω–∞–µ—Ç–µ –æ –≤—Å–µ–≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö. –ò—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç–µ –ø–æ—Å—Ç –µ—â–µ —Ä–∞–∑üëç\n\n<b>–ß—Ç–æ–±—ã –≤—ã–ª–æ–∂–∏—Ç—å –µ—â–µ –æ–¥–Ω–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è, –Ω–∞–∂–º–∏—Ç–µ /start</b>')
    await query.answer()
    await state.clear()
    for developer in developers:
        await client.send_message(chat_id=developer, text='<b>üõéÔ∏è –ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ!</b>\n\n<b>–í–≤–µ–¥–∏—Ç–µ <i>/pending</i> —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–µ—Å—å —Å–ø–∏—Å–æ–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏—Ö—Å—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π.</b>')
    

        


